{
  "$schema": "https://raw.githubusercontent.com/martinring/tmlanguage/master/tmlanguage.json",
  "name": "Total War Script",
  "patterns": [
    {
      "include": "#keywords"
    },
    {
      "include": "#constants"
    },
    {
      "include": "#functions"
    },
    {
      "include": "#console_commands"
    },
    {
      "include": "#events"
    },
    {
      "include": "#conditions"
    },
    {
      "include": "#keywords_other"
    },
    {
      "include": "#strings"
    },
    {
      "include": "#comments"
    }
  ],
  "repository": {
    "keywords": {
      "patterns": [
        {
          "name": "keyword.control.total_war_script",
          "match": "\\b(if|end_if|monitor_event|end_monitor|terminate_monitor|for_each|end_for|in)\\b"
        },
        {
          "name": "keyword.other.total_war_script",
          "match": "\\blocal|script|end_script\\b"
        }
      ]
    },
    "constants": {
      "patterns": [
        {
          "name": "constant.language.total_war_script",
          "match": "\\b(and|not)\\b"
        },
        {
          "name": "constant.numeric.total_war_script",
          "match": "\\b\\d+\\b"
        }
      ]
    },
    "functions": {
      "patterns": [
        {
          "name": "entity.name.function.total_war_script",
          "match": "\\bconsole_command\\b"
        },
        {
          "comment": "Functions relating to counters",
          "name": "entity.name.function.total_war_script",
          "match": "\\b(declare_counter|declare_persistent_counter|inc_counter|set_counter|store_counter|retrieve_counter)\\b"
        }
      ]
    },
    "keywords_other": {
      "name": "constant.language.total_war_script",
      "match": "\\b(settlement|faction|character|world|unit|exp|armor|general|named character|character|command|influence|management|subterfuge|age|weapon_lvl)\\b"
    },
    "console_commands": {
      "name": "entity.name.function.total_war_script",
      "match": "\\b(add_money|add_population|adjust_sea_bed|ai_turn_speed|amdb_max|amdb_min|amdb_offset|auto_win|bestbuy|bounds|building_debug|burn_piggies_burn|capture_settlement|character_reset|clear_messages|control|create_building|create_unit|damage_wall|date|dec_nwskip|diplomacy_mission|diplomatic_stance|disable_ai|dump_fac_score|dump_fertility|event|filter_coastlines|fire|force_battle_defeat|force_battle_victory|force_diplomacy|give_ancillary|give_trait|give_trait_points|halt_ai|highlight_construction|highlight_recruitment|highlight_soldier|ie|inc_nwskip|invulnerable_general|jericho|kill_character|kill_faction|lights|list_ancillaries|list_characters|list_traits|list_units|message_collation_set|move_character|mp|nw_stats|oliphaunt|output_unit_positions|perf_times|process_cq|process_rq|puppify_my_love|reapply_rigid_model_influence|regenerate_radar|reload_shaders|reload_textures|reset_display|run_ai|season|set_building_health|set_ranking_interval|shadow|show_all_messages|show_battle_circle|show_battle_line|show_battle_marker|show_battle_paths|show_battle_paths_for_unit|show_battle_street_plan|show_cursorstat|show_landings|show_terrain_lines|surrender_regions|test_ancillary_localisation|test_domination_scroll|test_message|test_network_scroll|test_victory_scroll|toggle_chat_log|toggle_coastlines|toggle_flowing_water|toggle_fow|toggle_game_update|toggle_overlay|toggle_perfect_spy|toggle_pr|toggle_restrictcam|toggle_terrain|toggle_tow|toggle_underlay|trigger_advice|upgrade_effect|victory|write_ui_cache|zoom|zoom_to_unit)\\b"
    },
    "events": {
      "name": "entity.name.type.total_war_script",
      "match": "\\b(PreBattle|PreBattleWithdrawal|BattleAiCommenced|BattleDelayPhaseCommenced|BattleDeploymentPhaseCommenced|BattleConflictPhaseCommenced|BattlePlayerUnitAttacksEnemyUnit|BattleEnemyUnitAttacksPlayerUnit|BattlePlayerAttacksSettlementBuilding|BattleEnemyAttacksSettlementBuilding|BattleUnitGoesBerserk|BattlePlayerUnitGoesBerserk|BattleEnemyUnitGoesBerserk|BattleUnitRouts|BattlePlayerUnitRouts|BattleEnemyUnitRouts|BattlePlayerSiegeEngineDestroyed|BattleEnemySiegeEngineDestroyed|PostBattle|BattleArmyRouted|BattleGeneralKilled|BattleGeneralRouted|BattleReinforcementsArrive|BattleSiegeEngineDestroyed|BattleSiegeEngineDocksWall|BattleGatesAttackedByEngine|BattleGatesAttackedByPlayerEngine|BattleGatesAttackedByEnemyEngine|BattleBattleGatesDestroyedByEngine|BattleWallsBreachedByEngine|BattleWallsCaptured|BattleFinished|EnteredCityView|BattleMinimapAction|BattlePlayerUnitSelected|EnterTacticalMode|BattleReinforcementsHack|FactionTurnStart|FactionWarDeclared|HordeFormed|FactionTurnEnd|HireMercenaries|GeneralCaptureResidence|GeneralCaptureWonder|GeneralCaptureSettlement|LeaderDestroyedFaction|Disaster|CharacterDamagedByDisaster|GeneralAssaultsResidence|OfferedForAdoption|LesserGeneralOfferedForAdoption|OfferedForMarriage|BrotherAdopted|BecomesFactionLeader|BecomesFactionHeir|TakeOffice|CeasedFactionLeader|CeasedFactionHeir|LeaveOffice|UngarrisonedFort|LostLegionaryEagle|CapturedLegionaryEagle|RecapturedLegionaryEagle|SenateExposure|QuaestorInvestigationMinor|QuaestorInvestigation|QuaestorInvestigationMajor|PopularSupportForOverthrow|SenateReadyToOutlawFaction|SenateOutlawsFaction|NewTurnStart|ScriptPromptCallback|FactionDestroyed|Birth|CharacterComesOfAge|CharacterMarries|CharacterBecomesAFather|CharacterTurnStart|CharacterTurnEnd|CharacterTurnEndInSettlement|GeneralDevastatesTile|ConstructionItemClicked|RecruitmentItemClicked|RecruitmentPopulated|ConstructionPopulated|AgentListPopulated|MoveRetinuePopulated|MoveRetinuePressed|MoveRetinueAncillarySelected|MoveRetinueAncillaryDeselected|MissionSelected|AgentSelected|ScrollDidOpen|UnitHasRouted|BattleUnitActionStatus|DiplomacyScrollPopulated|ItemDeselected|UnitInfoOpened|AdvisorAudioStopped|SpyMission|ExecutesASpyOnAMission|LeaderOrderedSpyingMission|AssassinationMission|ExecutesAnAssassinOnAMission|LeaderOrderedAssassination|SufferAssassinationAttempt|SabotageMission|LeaderOrderedSabotage|BriberyMission|LeaderOrderedBribery|AcceptBribe|RefuseBribe|Insurrection|DiplomacyMission|LeaderOrderedDiplomacy|LeaderSenateMissionSuccess|LeaderSenateMissionFailed|SettlementTurnStart|SettlementTurnEnd|NewAdmiralCreated|UnitTrained|GovernorUnitTrained|BuildingCompleted|GovernorBuildingCompleted|PlugInCompleted|GovernorPlugInCompleted|AgentCreated|GovernorAgentCreated|BuildingDestroyed|GovernorBuildingDestroyed|CityRiots|GovernorCityRiots|CityRebels|GovernorCityRebels|GovernorThrowGames|GovernorThrowRaces|UngarrisonedSettlement|EnslavePopulation|ExterminatePopulation|CitySacked|CharacterSelected|SettlementSelected|EnemySettlementSelected|MultiTurnMove|CharacterPanelOpen|SettlementPanelOpen|FinancesPanelOpen|FactionSummaryPanelOpen|FamilyTreePanelOpen|DiplomaticStandingPanelOpen|SenateMissionsPanelOpen|SenateOfficesPanelOpen|DiplomacyPanelOpen|PreBattlePanelOpen|RecruitmentPanelOpen|ConstructionPanelOpen|TradePanelOpen|HireMercenariesPanelOpen|NavalAutoResolvePanelOpen|IncomingMessage|MessageOpen|RequestBuildingAdvice|RequestTrainingAdvice|RequestMercenariesAdvice|ButtonPressed|ShortcutTriggered|ScrollOpened|ScrollClosed|AdviceSupressed|ScrollAdviceRequested|PreBattleScrollAdviceRequested|NavalPreBattleScrollAdviceRequested|SettlementScrollAdviceRequested|Idle|AbandonShowMe|ScriptedAdvice|DeclineAutomatedSettlementManagement|EscPressed|GameReloaded|FirstStratUpdates|MovieStopped|SelectionAssistPossible|SettlementButtonPressed|WorldScriptTerminate|CampaignHudShown|ContextPopupInteraction|DiplomacyConstructingOffer|DiplomacyConstructingCounterOffer|DiplomacyOpponentPresentsOffer|DiplomacyOpponentPresentsCounterOffer|FactionSummary|FactionSenate|FactionSenatePolicy|FactionSenateMissions|FactionSenateOfficials|FactionSenateFloor|FactionFactions|FactionDetails|FactionFamilyTree|FactionRankings|FactionLists|SettlementCharacter|SettlementTrade|SettlementOverview|SpySelected|DiplomatSelected|AssassinSelected|FleetSelected|CampaignMapGesture|CampaignDoingBadly|BattleMapGesture|HideBattleUI|FeralNewsVisible|AgentHubOpened|MoveRetinueOpened|OwnFactionDetailsOpened|DiplomaticStandingShown|FactionFinancesShown|FamilyTreeShown|SendAgentPanel|SettlementDetailsShown|CharacterInfoScreen|FriendlyCharacterSelected|EnemyCharacterSelected|FriendlySettlementSelected|EnemySettlementSelected|MapOverlayOpened|SiegeDetailsShown|PreBattleScreen|TacticalMapShown|PostBattleScreen|UnitsGrouped|EnteredBattle|AdvisorOpened|FormationTypesShown|MerchantSelected|NavalCombatStarted|MergeArmiesOpened|RoutesBlockaded|ElectionResults|BattleToggleMenu|AmbushMode|NewsTabClosed|NewsTabOpened|BattleNewsTabOpened|QuickListsOpened|EmbargoIsAvailable|RebelCharacterSelected|HighTaxesCauseDisorder|FailedToEndTurn)\\b"
    },
    "conditions": {
      "name": "entity.name.type.total_war_script",
      "match": "\\b(HasResource|I_InBattle|WonBattle|I_WonBattle|Routs|Ally_Routs|GeneralHPLostRatioinBattle|GeneralNumKillsInBattle|GeneralFoughtInCombat|PercentageOfArmyKilled|I_PercentageOfArmyKilled|PercentageEnemyKilled|PercentageBodyguardKilled|PercentageRoutedOffField|NumKilledGenerals|PercentageUnitCategory|NumFriendsInBattle|NumEnemiesInBattle|GeneralFoughtFaction|GeneralFoughtCulture|I_ConflictType|IsNightBattle|BattleSuccess|BattleOdds|WasAttacker|I_BattleAiAttacking|I_BattleAiAttackingSettlement|I_BattleAiDefendingSettlement|I_BattleAiDefendingHill|I_BattleAiDefendingCrossing|I_BattleAiScouting|I_BattleIsRiverBattle|I_BattleIsSiegeBattle|I_BattleIsSallyOutBattle|I_BattleIsFortBattle|I_BattleAttackerNumSiegeEngines|I_BattleAttackerNumArtilleryCanPenetrateWalls|I_BattleDefenderNumNonMissileUnitsOnWalls|I_BattleDefenderNumMissileUnitsOnWalls|I_BattleSettlementWallsBreached|I_BattleSettlementGateDestroyed|I_BattleSettlementTowerDefence|I_BattleSettlementGateDefence|I_BattleSettlementFortificationLevel|BattleBuildingType|I_BattleSettlementGateStrength|I_BattleNumberOfRiverCrossings|BattlePlayerUnitClass|BattleEnemyUnitClass|BattlePlayerUnitCategory|BattleEnemyUnitCategory|BattlePlayerUnitSiegeEngineClass|BattleEnemyUnitSiegeEngineClass|BattlePlayerUnitOnWalls|BattleEnemyUnitOnWalls|BattlePlayerCurrentFormation|BattleEnemyCurrentFormation|BattlePlayerUnitCloseFormation|BattleEnemyUnitCloseFormation|BattlePlayerUnitSpecialAbilitySupported|BattleEnemyUnitSpecialAbilitySupported|BattlePlayerUnitSpecialAbilityActive|BattleEnemyUnitSpecialAbilityActive|BattlePlayerMountClass|BattleEnemyMountClass|BattlePlayerUnitMeleeStrength|BattleEnemyUnitMeleeStrength|BattlePlayerUnitMissileStrength|BattleEnemyUnitMissileStrength|BattlePlayerUnitSpecialFormation|BattleEnemyUnitSpecialFormation|BattlePlayerUnitEngaged|BattleEnemyUnitEngaged|BattlePlayerActionStatus|BattleEnemyActionStatus|BattlePlayerUnitMovingFast|BattleEnemyUnitMovingFast|BattleRangeOfAttack|BattleDirectionOfAttack|BattleIsMeleeAttack|I_BattlePlayerArmyPercentageOfUnitClass|I_BattleEnemyArmyPercentageOfUnitClass|I_BattlePlayerArmyPercentageOfUnitCategory|I_BattleEnemyArmyPercentageOfUnitCategory|I_BattlePlayerArmyPercentageOfMountClass|I_BattleEnemyArmyPercentageOfMountClass|I_BattlePlayerArmyPercentageOfClassAndCategory|I_BattleEnemyArmyPercentageOfClassAndCategory|I_BattlePlayerArmyPercentageOfSpecialAbility|I_BattleEnemyArmyPercentageOfSpecialAbility|I_BattlePlayerArmyPercentageCanHide|I_BattleEnemyArmyPercentageCanHide|I_BattlePlayerArmyPercentageCanSwim|I_BattleEnemyArmyPercentageCanSwim|I_BattlePlayerArmyIsAttacker|I_BattlePlayerAllianceOddsInFavour|I_BattlePlayerAllianceOddsAgainst|TotalSiegeWeapons|I_BattleStarted|I_IsUnitMoveFastSet|I_IsUnitMoving|I_IsUnitIdle|I_IsUnitRouting|I_IsUnitUnderFire|I_IsUnitEngaged|I_IsUnitEngagedWithUnit|I_UnitFormation|I_PercentageUnitKilled|I_UnitPercentageAmmoLeft|I_UnitDistanceFromPosition|I_UnitDistanceFromLine|I_UnitDistanceFromUnit|I_UnitInRangeOfUnit|I_UnitDestroyed|I_UnitEnemyUnitInRadius|I_IsUnitGroupMoving|I_IsUnitGroupEngaged|I_IsUnitGroupIdle|I_IsUnitGroupDestroyed|I_PercentageUnitGroupKilled|I_UnitGroupFormation|I_UnitGroupDistanceFromPosition|I_UnitGroupDistanceFromGroup|I_UnitGroupInRangeOfUnit|I_UnitInRangeOfUnitGroup|I_UnitGroupInRangeOfUnitGroup|I_PlayerInRangeOfUnitGroup|I_PlayerInRangeOfUnit|I_UnitTypeSelected|UnitType|I_UnitSelected|I_MultipleUnitsSelected|I_SpecificUnitsSelected|I_IsCameraZoomingToUnit|I_BattleEnemyArmyPercentageOfMatchingUnits|I_BattleEnemyArmyNumberOfMatchingUnits|I_BattlePlayerArmyPercentageOfMatchingUnits|I_BattlePlayerArmyNumberOfMatchingUnits|Trait|FatherTrait|FactionLeaderTrait|Attribute|RemainingMPPercentage|I_RemainingMPPercentage|I_CharacterCanMove|NoActionThisTurn|AgentType|TrainedAgentType|DisasterType|CultureType|OriginalFactionType|OriginalCultureType|IsGeneral|IsAdmiral|EndedInSettlement|IsFactionLeader|IsFactionHeir|IsMarried|AtSea|InEnemyLands|InBarbarianLands|InUncivilisedLands|IsBesieging|IsUnderSiege|I_WithdrawsBeforeBattle|EndedInEnemyZOC|AdviseAction|I_CharacterTypeNearCharacterType|I_CharacterTypeNearTile|FactionType|TargetFactionType|FactionCultureType|TargetFactionCultureType|TrainedUnitCategory|UnitCategory|SenateMissionTimeRemaining|MedianTaxLevel|ModeTaxLevel|I_ModeTaxLevel|MissionSuccessLevel|MissionSucceeded|MissionFactionTargetType|MissionCultureTargetType|DiplomaticStanceFromCharacter|DiplomaticStanceFromFaction|FactionHasAllies|LosingMoney|I_LosingMoney|SupportCostsPercentage|Treasury|OnAWarFooting|I_FactionBesieging|I_FactionBesieged|I_NumberOfSettlements|I_NumberOfHeirs|I_FactionNearTile|SettlementsTaken|BattlesFought|BattlesWon|BattlesLost|DefensiveSiegesFought|DefensiveSiegesWon|OffensiveSiegesFought|OffensiveSiegesWon|FactionwideAncillaryExists|RandomPercent|TrueCondition|WorldwideAncillaryExists|SettlementName|GovernorBuildingExists|SettlementBuildingExists|BuildingFinishedByGovernor|SettlementBuildingFinished|GovernorPlugInExists|GovernorPlugInFinished|GovernorTaxLevel|SettlementTaxLevel|GovernorInResidence|GovernorLoyaltyLevel|SettlementLoyaltyLevel|RiotRisk|BuildingQueueIdleDespiteCash|TrainingQueueIdleDespiteCash|I_SettlementExists|I_SettlementOwner|AdviseFinancialBuild|AdviseBuild|AdviseRecruit|SettlementPopulationMaxedOut|SettlementPopulationTooLow|SettlementAutoManaged|PercentageOfPopulationInGarrison|GarrisonToPopulationRatio|HealthPercentage|SettlementHasPlague|IsFortGarrisoned|IsSettlementGarrisoned|IsSettlementRioting|I_NumberUnitsInSettlement|CharacterIsLocal|TargetCharacterIsLocal|SettlementIsLocal|TargetSettlementIsLocal|RegionIsLocal|TargetRegionIsLocal|ArmyIsLocal|TargetArmyIsLocal|FactionIsLocal|I_LocalFaction|TargetFactionIsLocal|I_TurnNumber|I_MapName|I_ThreadCount|I_IsTriggerTrue|IncomingMessageType|I_AdvisorVerbosity|I_AdvisorVisible|I_CharacterSelected|I_AgentSelected|I_SettlementSelected|ShortcutTriggered|I_AdvancedStatsScrollIsOpen|ButtonPressed|ScrollOpened|ScrollClosed|ScrollAdviceRequested|I_CompareCounter|I_TimerElapsed|I_SoundPlaying|I_AdvisorSpeechPlaying)\\b"
    },
    "strings": {
      "name": "string.quoted.double.total_war_script",
      "begin": "\"",
      "end": "\"",
      "patterns": [
        {
          "name": "constant.character.escape.total_war_script",
          "match": "\\\\."
        }
      ]
    },
    "comments": {
      "name": "comment.line.total_war_script",
      "begin": ";",
      "end": "\\n"
    }
  },
  "scopeName": "source.total_war_script"
}